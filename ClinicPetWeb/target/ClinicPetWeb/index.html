<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Клиника домашних животных</title>

	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="js/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="js/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

	<script type="text/javascript" src="js/jquery-1.12.1.min.js"></script>

	<script type="text/javascript">
		function createClient() {
			if (validate()) {
				$.ajax('user/json', {
					method : 'post',
					data: JSON.stringify({clientName : $('input[name="clientName"]').val()}),
					complete: function(data) {
						loadUsers();
					}
				});
			}
		}

		function validate() {
			var result = true;
			if ($('input[name="clientName"]').val() == '' ||
					$('input[name="petName"]').val() == '') {
				if ($('input[name="clientName"]').val() == '') {
					$('input[name="petName"]').css('box-shadow', 'rgba(102, 175, 233, 0) 0px 0px 25px inset');

					$('input[name="clientName"]').css('box-shadow', 'rgba(102, 175, 233, 1) 0px 0px 25px inset');
				}
				else {
					$('input[name="clientName"]').css('box-shadow', 'rgba(102, 175, 233, 0) 0px 0px 25px inset');

					$('input[name="petName"]').css('box-shadow', 'rgba(102, 175, 233, 1) 0px 0px 25px inset');
				}
				result = false;
			}
			return result;
		}

		function loadUsers() {
			$.ajax('user/json', {
				method : 'get',
				success: function(data) {
					var table;
					var size = data.length;
					for (var i = 0; i != size; ++i) {
						table += "<tr>" +
								"<td>" + data[i].clientName + "</td>" +
								"<td>" + data[i].petType + "</td>" +
								"<td>" + data[i].petName + "</td>" +
								"<td>" + data[i].petSex + "</td>" +
								"<td>" + data[i].petAge + "</td>" +
								"</tr>"
					}

					$('.createClient').html(table);
				}
			});
		}


	</script>
	<script type="text/javascript">
		$(function() {
			loadUsers();
		});
	</script>
</head>
<body>

<div class="container">
	<header>
		<div>
			<h1>Клиника домашних <br />животных</h1>
			<p class="lead">Внесите данные о клиенте:</p>
		</div>
		<form action="">
			<div class="form-group">
				<input type="text" name="clientName" class="form-control input-control" placeholder="Имя клиента" required>
				<br />
				<input type="text" name="petType" class="form-control input-control" placeholder="Тип питомца">
				<input type="text" name="petName" class="form-control input-control" placeholder="Имя питомца" required>
				<select name="petSex" class="form-control input-control">
					<option selected="selected" disabled>Пол питомца</option>
					<option value="male">Мужской</option>
					<option value="female">Женский</option>
				</select>
				<input type="number" name="petAge" class="form-control input-control" min="0" max="300" placeholder="Возраст питомца">
				<input type="submit" class="btn btn-primary input-control" value="Создать" onclick="return createClient();">
			</div>
		</form>
	</header>
	<hr />
	<div class="body">
		<!-- <h1>Список пуст!</h1> -->
		<table border="2" class="table">
			<caption>База данных клиентов</caption>
			<tbody>
			<tr>
				<th>Имя клиента</th>
				<th>Тип питомца</th>
				<th>Имя питомца</th>
				<th>Пол питомца</th>
				<th>Возраст питомца</th>
			</tr>
			<!--<tr>-->
				<!--<td colspan="5" >Список пуст!</td>-->
			<!--</tr>-->
			<tr>
				<td>Ячейка</td>
				<td>Ячейка</td>
				<td>Ячейка</td>
				<td>Ячейка</td>
				<td>Ячейка</td>
			</tr>

			<div class="createClient"></div>
			</tbody>
		</table>
	</div>
</div>

<script src="js/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
</body>
</html>